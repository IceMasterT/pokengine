<!doctype html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>Battle Engine</title>
		<script src="scripts/functions/functions.js"></script>
		<script src="scripts/functions/random.js"></script>
		<script src="scripts/functions/Sprite.js"></script>
		<script src="scripts/data/constants.js"></script>
		<script src="scripts/objects/unique/Type.js"></script>
		<script src="scripts/objects/unique/Move.js"></script>
		<script src="scripts/objects/unique/Map.js"></script>
		<script src="scripts/data/Moves.js"></script>
		<script src="scripts/data/Pokemon.js"></script>
		<script src="scripts/data/Abilities.js"></script>
		<script src="scripts/data/Items.js"></script>
		<script src="scripts/data/machines.js"></script>
		<script src="scripts/data/Badges.js"></script>
		<script src="scripts/objects/unique/Settings.js"></script>
		<script src="scripts/objects/unique/Textbox.js"></script>
		<script src="scripts/objects/unique/Display.js"></script>
		<script src="scripts/objects/unique/View.js"></script>
		<script src="scripts/objects/unique/Game.js"></script>
		<script src="scripts/objects/unique/Pokedex.js"></script>
		<script src="scripts/objects/unique/visuals.js"></script>
		<script src="scripts/objects/general/bag.js"></script>
		<script src="scripts/objects/general/party.js"></script>
		<script src="scripts/objects/general/character.js"></script>
		<script src="scripts/objects/general/battler.js"></script>
		<script src="scripts/objects/general/pokemon.js"></script>
		<script src="scripts/objects/unique/Client.js"></script>
		<script src="scripts/objects/unique/Battle.js"></script>
		<link rel="stylesheet" href="battle.css">
	</head>
	<body>
		<canvas id="battle" class="centre"></canvas>
		<canvas id="fps" class="corner"></canvas>
		<button id="connect">Connect</button>
		<span>with the name</span>
		<input id="name" type="text" value="Dark Matter">
		<br>
		<div id="invitations" class="hidden">
			<span>Invite someone to a</span>
			<div class="select"><select id="style">
				<option value="normal">normal</option>
				<option value="double">double</option>
			</select></div><span>battle,<br>with</span>
			<div class="select"><select id="weather">
				<option value="clear">clear skies</option>
				<option value="intenseSunlight">sun</option>
				<option value="rain">rain</option>
				<option value="hail">hail</option>
			</select></div><span>, in a</span>
			<div class="select"><select id="scene">
				<option value="clearing">clearing</option>
			</select></div><span>.</span>
			<br>
		</div>
		<ul id="users"></ul>
		<script>
		window.addEventListener("load", function () {
			Game.canvas.initialise();

			document.getElementById("connect").addEventListener("mousedown", function (event) {
				event.stopPropagation();
				document.getElementById("connect").innerHTML = "Connecting...";
				document.getElementById("connect").disabled = true;
				Client.connect(document.getElementById("name").value || "anonymous");
			});

			Object.observe(Client, function (changes) {
				foreach(changes, function (change) {
					if (change.name === "connected") {
						if (Client.connected) {
							document.getElementById("connect").innerHTML = "Connected";
							document.getElementById("connect").className = "active";
						} else {
							document.getElementById("connect").innerHTML = "Connect";
							document.getElementById("connect").className = "";
							document.getElementById("connect").disabled = false;
						}
					}
				});
			});

			document.getElementById("name").addEventListener("mousedown", function (event) {
				event.stopPropagation();
			});

			if (localStorage["name"])
				document.getElementById("name").value = localStorage["name"];

			document.getElementById("name").addEventListener("input", function (event) {
				localStorage["name"] = document.getElementById("name").value;
			});
		});
		</script>
	</body>
</html>